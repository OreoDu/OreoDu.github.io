{"title":"SQL Basics","date":"2020-09-16T07:42:00.000Z","thumbnail":"https://i.loli.net/2020/09/09/y7JDtRIKMCnAuzq.jpg","slug":"20200916-SQL-Basics","comments":true,"tags":["SQL"],"categories":["Programming"],"updated":"2020-09-23T06:37:40.566Z","content":"<h1 id=\"SQL-Basics\">SQL Basics<a href=\"post/20200916-SQL-Basics#SQL-Basics\"></a></h1><h3 id=\"Overview\">Overview<a href=\"post/20200916-SQL-Basics#Overview\"></a></h3><p>(概略图)</p>\n<p><strong>· materials:</strong><br> · <a href=\"https://inst.eecs.berkeley.edu/~cs61a/su19/\" target=\"_blank\" rel=\"noopener\"><u>CS61A Summer 2019 at UCB</u></a></p>\n<p>SQL is an example of a (declarative) language with interacts with a  database management system (DBMS) in order to make data processing easier and faster</p>\n<h3 id=\"Part-1-Create-the-Table\">Part.1 Create the Table<a href=\"post/20200916-SQL-Basics#Part-1-Create-the-Table\"></a></h3><p><strong>· Make a table</strong></p>\n<p>A CREATE TABLE statement gives a global name to a table.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE TABLE [name]([columns]); # create empty table</span><br><span class=\"line\"></span><br><span class=\"line\">CREATE TABLE dogs(name, fur, phrase DEFAULT &apos;woof&apos;); # using default values</span><br></pre></td></tr></table></figure>\n\n<p><strong>· Create rows of data</strong></p>\n<p><code>CREATE TABLE [name] AS ...;</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT [expr] AS [name], [expr] AS [name], ... UNION</span><br><span class=\"line\">SELECT [expr] AS [name], [expr] AS [name], ... UNION</span><br><span class=\"line\">SELECT [expr] AS [name], [expr] AS [name], ...;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">CREATE TABLE cities AS</span><br><span class=\"line\">  SELECT 38 AS latitude, 122 AS longitude, &quot;Berkeley&quot; AS name   UNION</span><br><span class=\"line\">  SELECT 42,\t\t\t    71,\t\t\t     &quot;Cambridge&quot;        UNION</span><br><span class=\"line\">  SELECT 45,\t\t\t    93,\t\t\t     &quot;Minneapolis&quot;;</span><br></pre></td></tr></table></figure>\n\n<p><strong>· Create rows of data from existing tables</strong></p>\n<p>A <code>SELECT</code> statement can specify an input table using a <code>FROM</code> clause. A subset of the rows of the input table can be selected using a <code>WHERE</code> clause. Can declare the order of the remaining rows using an <code>ORDER BY</code> clause. Otherwise, no order. Column descriptions determine how each input row is projected to a result row.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT [columns] FROM [table] WHERE [condition] </span><br><span class=\"line\">ORDER BY [order] [ASC/DESC] LIMIT [number];</span><br><span class=\"line\"></span><br><span class=\"line\">SELECT &quot;west coast&quot; AS region, name FROM cities WHERE longitude &gt;= 115 UNION</span><br><span class=\"line\">SELECT &quot;other&quot;, \t\t\t\t name FROM cities WHERE longitude &lt; 115;</span><br></pre></td></tr></table></figure>\n\n<p><strong>· Arithmetic in SELECT Statements</strong></p>\n<p>In a SELECT expression, column names evaluate to row values.Arithmetic expressions can combine row values and constants.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT single + 2 * couple AS total FROM restaurant;</span><br></pre></td></tr></table></figure>\n\n<p><strong>· Join the Table</strong></p>\n<p>When we join two tables, we get a new table with one row for each combination of rows from the original tables.</p>\n<p><code>SELECT * FROM table1, table2;</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM parents, dogs;</span><br><span class=\"line\">SELECT parent FROM parents, dogs WHERE child = name AND fur = &quot;curly&quot;;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT s.name, s.artist </span><br><span class=\"line\">      FROM songs AS s, artists AS ar, albums AS al</span><br><span class=\"line\">      WHERE album = al.name AND s.artist = ar.name</span><br><span class=\"line\">            AND release_year = 2010</span><br><span class=\"line\">            ORDER BY first_year_active;</span><br></pre></td></tr></table></figure>\n\n<p><strong>· Aliasing</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT a.child AS first, b.child AS second FROM parents AS a, parents AS b WHERE a.parent = b.parent AND a.child &lt; b.child;</span><br></pre></td></tr></table></figure>\n\n<p><strong>· String Expression</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sql&gt; SELECT name || &quot; dog&quot; FROM dogs;</span><br><span class=\"line\">abraham dog</span><br><span class=\"line\">barack dog</span><br><span class=\"line\">clinton dog</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Part-2-Aggregation\">Part.2 Aggregation<a href=\"post/20200916-SQL-Basics#Part-2-Aggregation\"></a></h3><p><strong>Aggregation</strong> is the process of doing operations on <em>groups of rows</em> instead of just a single row. SQL provides aggregate functions whose return values can be used as entries in a column.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT AVG(age) AS avg_age FROM dogs;</span><br><span class=\"line\">SELECT COUNT(*) AS count FROM dogs;</span><br><span class=\"line\">SELECT SUM(age) AS sum_age FROM dogs;</span><br><span class=\"line\">SELECT MIN(name) AS min_name FROM dogs;</span><br></pre></td></tr></table></figure>\n\n<p><strong>· Group</strong></p>\n<p>By default, aggregation is performed over all the rows of the table. We can <code>GROUP BY</code> any valid SQL expression, which includes using multiple column names and operators. We can specify  a single group consists of all rows for which [expression] evaluates to the same value. The output table will have <strong>one row</strong> per group. </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT [columns] FROM [table] WHERE [condition] </span><br><span class=\"line\">       GROUP BY [expression]</span><br><span class=\"line\">       ORDER BY [order] [ASC/DESC]</span><br><span class=\"line\">       LIMIT [number];</span><br><span class=\"line\"></span><br><span class=\"line\">SELECT fur, AVG(age) AS avg_age FROM dogs GROUP BY fur;</span><br></pre></td></tr></table></figure>\n\n<p><strong>· Filtering Groups</strong></p>\n<p>We know how to filter individual rows using the <code>WHERE</code> clause.To filter groups, use the <code>HAVING [condition]</code> clause.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT fur, AVG(age) AS avg_age</span><br><span class=\"line\">       FROM dogs GROUP BY fur</span><br><span class=\"line\">       HAVING COUNT(*) &gt; 1;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Part-3-Mutating-Tables\">Part.3 Mutating Tables<a href=\"post/20200916-SQL-Basics#Part-3-Mutating-Tables\"></a></h3><p><strong>· Remove Table</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DROP TABLE [IF EXISTS] [name];</span><br><span class=\"line\">DROP TABLE IF EXISTS parents;</span><br></pre></td></tr></table></figure>\n\n<p><strong>· Inserting Records</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">INSERT INTO [table]([columns]) VALUES([values]), ([values]);</span><br><span class=\"line\"></span><br><span class=\"line\">INSERT INTO dogs(name, fur) VALUES(&apos;fillmore&apos;, &apos;curly&apos;);</span><br><span class=\"line\">INSERT INTO dogs VALUES(&apos;delano&apos;, &apos;long&apos;, &apos;hi!&apos;);</span><br></pre></td></tr></table></figure>\n\n<p><strong>· Updating Records</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">UPDATE [table] SET [column] = [expression] WHERE [condition];</span><br><span class=\"line\">DELETE FROM [table] WHERE [condition];</span><br><span class=\"line\"></span><br><span class=\"line\">UPDATE dogs SET phrase = &apos;WOOF&apos; WHERE fur = &apos;curly&apos;;</span><br><span class=\"line\">DELETE FROM dogs WHERE fur = &apos;curly&apos; and phrase = &apos;WOOF&apos;;</span><br></pre></td></tr></table></figure>\n\n","prev":{"title":"Java Basics 01","slug":"20200917-Java-Basics-01"},"next":{"title":"Scheme Basics","slug":"20200915-Scheme-Basics"},"link":"https://oreodu.github.io/post/20200916-SQL-Basics/","toc":[{"title":"SQL Basics","id":"SQL-Basics","index":"1"}],"reward":true,"copyright":{"author":null,"link":"<a href=\"https://oreodu.github.io/post/20200916-SQL-Basics/\" title=\"SQL Basics\">https://oreodu.github.io/post/20200916-SQL-Basics/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"}}